addpath('../Analysis');
addpath('../Utilities');

%% Establish IEEG Sessions
% Establish IEEG Sessions through the IEEGPortal. This will allow on demand
% data access

params = loadParametersAsla;
session = loadData(params);

%remove artifact channels
%[ch_keep, ch_remove, stats] = removeArtifactChannels_par(params);

%% Run Detections 
ch_keep = cell(numel(session.data),1);
for i = 1:numel(session.data)
    ch_keep{i} = 1; %manually keep the first channel only
end

algo='bursts';
prefix='bursts_initial';
dparams.ch_keep = ch_keep;
dparams.thres = 2;
dparams.maxThres = 100;
dparams.minDur = 1.25;
dparams.maxDur = 9;
dparams.FILTFLAG = 1;

[timesUSec, channels] = p_detect_bursts_par(params,dparams);
%issues: 4
for i = 1:numel(session.data)
     %try
     fprintf('Detecting in : %s\n',session.data(i).snapName);
%      leftMargin = [0.05 0 0.05];
%      rightMargin = [0.05 0.15 0.05]; 
     %standalone_spike_keating(session.data(i),'spike_keating_manual',300,1:numel(session.data(i).channels),stdflag,spikethres(i),200,100);  
     try
        [spikeTimes, spikeChannels] = spike_AR(session.data(i),channelIdxs{i},12);
        filtflag = 1;
        [burstTimes, burstChannels] = burst_detector_v2(session.data(i),channelIdxs{i},2,100,1.25,9,filtFlag);

        idx = arrayfun(@(x)sum(x(:,1)>burstTimes(:,1) & x(:,1)<burstTimes(:,2)),spikeTimes(:,1));
        idx = idx>0;
        spikeTimes(idx,:) = [];
        spikeChannels(idx,:) = [];
        
        uploadAnnotations(session.data(i), 'burst_detections',burstTimes,burstChannels,'burst');
        uploadAnnotations(session.data(i), 'spike_detections',spikeTimes,spikeChannels,'spike');
     catch ME
        disp(ME)
        fprintf('Failed detecting in: %s\n',session.data(i).snapName);
     end
%      standalone_spike_keating_std(session.data(i),'spike_keating_auto',600,channelIdxs{i},7,200,80); 
%      standalone_spike_LL(session.data(i),'spike_LL_filtered',channelIdxs{i},.1,4.5,1);
%     
%      majorityVote(session.data(i),2,'spike_detections',leftMargin,rightMargin,'spike_keating_auto','spike_LL_filtered','spike_AR');
%      session.data(i).removeAnnLayer('spike_keating_auto');
%      session.data(i).removeAnnLayer('spike_LL_filtered');
%      session.data(i).removeAnnLayer('spike_AR');
     %standalone_spike_keating(session.data(i),'spike_detections2',300,1:numel(session.data(i).channels),stdflag,spikethres(i),200,100); 
     %catch
     %end
end

%% CLUSTER BURSTS ONCE DETECTED ABOVE
%INITIAL CLUSTER
idxByDataset = clusterAllBursts(session.data,'burst_detections');
for i = 1:numel(session.data)
    idx = idxByDataset{i}; %GET IDXS FOR DATASET
   	annots = getAllAnnots(session.data(i),'burst_detections'); %GET ALL ANNOTS
    for j=1:max(idx) %FOR EACH CLUSTER
        fprintf('Adding cluster %d...',j)
        newLayerName = sprintf('burst_detections_%d',j);
        try
            session.data(i).removeAnnLayer(newLayerName); %TRY TO REMOVE IN CASE ALREADY PRESENT
        catch
        end
        annLayer = session.data(i).addAnnLayer(newLayerName);
        ann=annots(idx==j);
        numAnnot = numel(ann);
        startIdx = 1;
        %add annotations 5000 at a time (freezes if adding too many)
        for k = 1:ceil(numAnnot/5000)
            fprintf('Adding %d to %d\n',startIdx,min(startIdx+5000,numAnnot));
            annLayer.add(ann(startIdx:min(startIdx+5000,numAnnot)));
            startIdx = startIdx+5000;
        end
        fprintf('...done!\n')
    end
end

%ARTIFACT REMOVAL
models = train_burst_artifact_model('B-Amodel.mat');

%CLASSIFY AND UPLOAD
[bursts, artifacts] = classify_bursts(session.data,{'burst_detections_2','burst_detections_3'},'B-Amodel.mat',{'burst_real','burst_artifact'});

%% Cluster spikes
idx = clusterSpikes(session.data,'spike_detections');
%% SEIZURE DETECTOR
seizthres = ones(23,1)*300;
seizmaxthresh = ones(23,1)*1000;
for i = subj
    try
        fprintf('Detecting seizures in : %s\n',session.data(i).snapName);
        standalone_seizure_v1(session.data(i),'seizure_detections',120,1:numel(session.data(i).channels),seizthres(i),seizmaxthresh(i),9,1000);
    catch ME
        disp(ME)
    end
end


%%
% <html><br></html>
%% DCN
generate_feature_plots(session.data,channelIdxs,'dcn','html/figs/',[],5);
%%
% <html><br></html>

%% Spike Profile
% Generate spike profiles of all datasets. Spikes are detected using an
% algorithm by Keating, which takes as parameters 1. Spike amplitude
% threshold, 2. Duration of spike, 3. Duration of slow wave. Duration of
% spike was set to 200 ms, duration of slow wave to 100 ms, and spike
% amplitude was manually tuned for each dataset
generate_subj_plots(session.data,channelIdxs,'spike_detections','spike','html/figs/');
%%
% <html><br></html>

%% Burst Profile
% Generate burst profiles for all datasets. Bursts are calculated with the
% LL feature with a normalized threshold of 0.8. Datasets are filtered with a [1 100] bandpass and [58 62]
% (60 Hz noise) bandstop filter before standardizing to zero mean and unit
% variance over 300 second blocks. Bursts are defined with a duration of [1
% 9] seconds, determined by time above threshold.
generate_subj_plots(session.data,channelIdxs,'burst_detections','burst','html/figs/');
%%
% <html><br></html>

%% Seizure Profile
% Generate seizure profile for all datasets. Seizures are detected using
% the LL feature with manual thresholds for each dataset. Once the LL
% feature surpasses the threshold continuously for 10 seconds, it is
% defined as a seizure.
generate_subj_plots(session.data,channelIdxs,'seizure_detections','seizure','html/figs/');
%%
% <html><br></html>

%% Power bands
% Generate power plot over time for $\delta$ [1-4], $\theta$ (4-8], $\alpha$ (8-12], and
% $\beta$ (12-30] bands. Power is calculated over one minute intervals
% using pwelch for power spectral density estimation.
generate_feature_plots(session.data,channelIdxs,'power','html/figs/',[.04 0 .01 .12 .07],60);
%%
% <html><br></html>

%% Profiles
% <html>
% <p style="color:gray"> Sham </p>
% <p style="color:#00FFFF">Did not develop epilepsy </p>
% <p style="color:red">Developed epilepsy</p>
% <style type="text/css">
% table.org { margin-left: 25px; }
% table.org th { text-align:center; color:rgb(213,80,0); font-size:14px; font-weight:bold; }
% table.org td { text-align:center; vertical-align:middle; font-size:14px; font-weight:normal; }
% table.org p { font-size:10px; font-weight:normal; margin-bottom: 0px; }
% table.org img { width:200px; height:90px; margin-bottom:0px; cursor: alias; }
% table.org span>img { cursor: pointer; }
% table.org span:hover, table.org a:hover { background: gold; cursor: pointer; text-decoration: none; }
% table.org .na { background-color:#f8f8f8; }
% </style>
% <table class="org" border=1>
% <tr><th>IEEG Portal Dataset</th><th>Spike Profile</th><th>Burst Profile</th><th>Seizure Profile</th><th>Delta Power</th><th>Theta Power</th><th>Alpha Power</th><th>Beta Power</th><th>High Gamma</th></tr>
% <tr><td style="background-color:#00FFFF"><i>University of Eastern Finland</i><p>I010_A0001_D001<br>Rat<br>2 chs  06:20:43:19<br>200 Hz</td><td><a href="figs/I010_A0001_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0001_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0001_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0001_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0001_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0001_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0001_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0001_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0001_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0001_D001_delta-power.png" onClick="window.open('figs/I010_A0001_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0001_D001_delta-power.png"></a></td><td><a href="figs/I010_A0001_D001_theta-power.png" onClick="window.open('figs/I010_A0001_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0001_D001_theta-power.png"></a></td><td><a href="figs/I010_A0001_D001_alpha-power.png" onClick="window.open('figs/I010_A0001_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0001_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0001_D001_beta-power.png" onClick="wndow.open('figs/I010_A0001_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0001_D001_beta-power.png"></a></td><td><a href="figs/I010_A0001_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0001_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0001_D001_high-gamma-power.png"></a></td></tr>
% <tr><td style="background-color:gray"><i>University of Eastern Finland</i><p>I010_A0002_D001<br>Rat<br>2 chs  06:17:21:03<br>200 Hz</td><td><a href="figs/I010_A0002_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0002_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0002_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0002_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0002_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0002_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0002_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0002_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0002_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0002_D001_delta-power.png" onClick="window.open('figs/I010_A0002_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0002_D001_delta-power.png"></a></td><td><a href="figs/I010_A0002_D001_theta-power.png" onClick="window.open('figs/I010_A0002_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0002_D001_theta-power.png"></a></td><td><a href="figs/I010_A0002_D001_alpha-power.png" onClick="window.open('figs/I010_A0002_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0002_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0002_D001_beta-power.png" onClick="wndow.open('figs/I010_A0002_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0002_D001_beta-power.png"></a></td><td><a href="figs/I010_A0002_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0002_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0002_D001_high-gamma-power.png"></a></td></tr>
% <tr><td style="background-color:red"><i>University of Eastern Finland</i><p>I010_A0003_D001<br>Rat<br>2 chs  06:20:43:19<br>200 Hz</td><td><a href="figs/I010_A0003_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0003_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0003_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0003_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0003_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0003_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0003_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0003_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0003_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0003_D001_delta-power.png" onClick="window.open('figs/I010_A0003_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0003_D001_delta-power.png"></a></td><td><a href="figs/I010_A0003_D001_theta-power.png" onClick="window.open('figs/I010_A0003_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0003_D001_theta-power.png"></a></td><td><a href="figs/I010_A0003_D001_alpha-power.png" onClick="window.open('figs/I010_A0003_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0003_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0003_D001_beta-power.png" onClick="wndow.open('figs/I010_A0003_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0003_D001_beta-power.png"></a></td><td><a href="figs/I010_A0003_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0003_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0003_D001_high-gamma-power.png"></a></td></tr>
% <tr><td style="background-color:#00FFFF"><i>University of Eastern Finland</i><p>I010_A0004_D001<br>Rat<br>2 chs  06:20:43:19<br>200 Hz</td><td><a href="figs/I010_A0004_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0004_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0004_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0004_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0004_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0004_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0004_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0004_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0004_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0004_D001_delta-power.png" onClick="window.open('figs/I010_A0004_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0004_D001_delta-power.png"></a></td><td><a href="figs/I010_A0004_D001_theta-power.png" onClick="window.open('figs/I010_A0004_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0004_D001_theta-power.png"></a></td><td><a href="figs/I010_A0004_D001_alpha-power.png" onClick="window.open('figs/I010_A0004_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0004_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0004_D001_beta-power.png" onClick="wndow.open('figs/I010_A0004_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0004_D001_beta-power.png"></a></td><td><a href="figs/I010_A0004_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0004_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0004_D001_high-gamma-power.png"></a></td></tr>
% <tr><td style="background-color:#00FFFF"><i>University of Eastern Finland</i><p>I010_A0005_D001<br>Rat<br>2 chs  06:20:43:19<br>200 Hz</td><td><a href="figs/I010_A0005_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0005_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0005_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0005_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0005_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0005_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0005_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0005_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0005_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0005_D001_delta-power.png" onClick="window.open('figs/I010_A0005_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0005_D001_delta-power.png"></a></td><td><a href="figs/I010_A0005_D001_theta-power.png" onClick="window.open('figs/I010_A0005_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0005_D001_theta-power.png"></a></td><td><a href="figs/I010_A0005_D001_alpha-power.png" onClick="window.open('figs/I010_A0005_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0005_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0005_D001_beta-power.png" onClick="wndow.open('figs/I010_A0005_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0005_D001_beta-power.png"></a></td><td><a href="figs/I010_A0005_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0005_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0005_D001_high-gamma-power.png"></a></td></tr>
% <tr><td style="background-color:#00FFFF"><i>University of Eastern Finland</i><p>I010_A0006_D001<br>Rat<br>2 chs  06:20:43:19<br>200 Hz</td><td><a href="figs/I010_A0006_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0006_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0006_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0006_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0006_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0006_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0006_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0006_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0006_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0006_D001_delta-power.png" onClick="window.open('figs/I010_A0006_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0006_D001_delta-power.png"></a></td><td><a href="figs/I010_A0006_D001_theta-power.png" onClick="window.open('figs/I010_A0006_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0006_D001_theta-power.png"></a></td><td><a href="figs/I010_A0006_D001_alpha-power.png" onClick="window.open('figs/I010_A0006_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0006_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0006_D001_beta-power.png" onClick="wndow.open('figs/I010_A0006_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0006_D001_beta-power.png"></a></td><td><a href="figs/I010_A0006_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0006_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0006_D001_high-gamma-power.png"></a></td></tr>
% <tr><td style="background-color:red"><i>University of Eastern Finland</i><p>I010_A0008_D001<br>Rat<br>2 chs  06:17:21:03<br>200 Hz</td><td><a href="figs/I010_A0008_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0008_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0008_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0008_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0008_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0008_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0008_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0008_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0008_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0008_D001_delta-power.png" onClick="window.open('figs/I010_A0008_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0008_D001_delta-power.png"></a></td><td><a href="figs/I010_A0008_D001_theta-power.png" onClick="window.open('figs/I010_A0008_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0008_D001_theta-power.png"></a></td><td><a href="figs/I010_A0008_D001_alpha-power.png" onClick="window.open('figs/I010_A0008_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0008_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0008_D001_beta-power.png" onClick="wndow.open('figs/I010_A0008_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0008_D001_beta-power.png"></a></td><td><a href="figs/I010_A0008_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0008_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0008_D001_high-gamma-power.png"></a></td></tr>
% <tr><td style="background-color:gray"><i>University of Eastern Finland</i><p>I010_A0009_D001<br>Rat<br>2 chs  06:20:43:19<br>200 Hz</td><td><a href="figs/I010_A0009_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0009_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0009_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0009_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0009_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0009_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0009_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0009_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0009_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0009_D001_delta-power.png" onClick="window.open('figs/I010_A0009_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0009_D001_delta-power.png"></a></td><td><a href="figs/I010_A0009_D001_theta-power.png" onClick="window.open('figs/I010_A0009_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0009_D001_theta-power.png"></a></td><td><a href="figs/I010_A0009_D001_alpha-power.png" onClick="window.open('figs/I010_A0009_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0009_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0009_D001_beta-power.png" onClick="wndow.open('figs/I010_A0009_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0009_D001_beta-power.png"></a></td><td><a href="figs/I010_A0009_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0009_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0009_D001_high-gamma-power.png"></a></td></tr>
% <tr><td style="background-color:red"><i>University of Eastern Finland</i><p>I010_A0010_D001<br>Rat<br>2 chs  06:17:21:03<br>200 Hz</td><td><a href="figs/I010_A0010_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0010_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0010_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0010_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0010_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0010_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0010_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0010_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0010_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0010_D001_delta-power.png" onClick="window.open('figs/I010_A0010_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0010_D001_delta-power.png"></a></td><td><a href="figs/I010_A0010_D001_theta-power.png" onClick="window.open('figs/I010_A0010_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0010_D001_theta-power.png"></a></td><td><a href="figs/I010_A0010_D001_alpha-power.png" onClick="window.open('figs/I010_A0010_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0010_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0010_D001_beta-power.png" onClick="wndow.open('figs/I010_A0010_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0010_D001_beta-power.png"></a></td><td><a href="figs/I010_A0010_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0010_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0010_D001_high-gamma-power.png"></a></td></tr>
% <tr><td style="background-color:gray"><i>University of Eastern Finland</i><p>I010_A0011_D001<br>Rat<br>2 chs  06:20:43:19<br>200 Hz</td><td><a href="figs/I010_A0011_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0011_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0011_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0011_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0011_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0011_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0011_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0011_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0011_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0011_D001_delta-power.png" onClick="window.open('figs/I010_A0011_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0011_D001_delta-power.png"></a></td><td><a href="figs/I010_A0011_D001_theta-power.png" onClick="window.open('figs/I010_A0011_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0011_D001_theta-power.png"></a></td><td><a href="figs/I010_A0011_D001_alpha-power.png" onClick="window.open('figs/I010_A0011_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0011_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0011_D001_beta-power.png" onClick="wndow.open('figs/I010_A0011_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0011_D001_beta-power.png"></a></td><td><a href="figs/I010_A0011_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0011_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0011_D001_high-gamma-power.png"></a></td></tr>
% <tr><td style="background-color:red"><i>University of Eastern Finland</i><p>I010_A0012_D001<br>Rat<br>2 chs  06:20:43:19<br>200 Hz</td><td><a href="figs/I010_A0012_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0012_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0012_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0012_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0012_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0012_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0012_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0012_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0012_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0012_D001_delta-power.png" onClick="window.open('figs/I010_A0012_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0012_D001_delta-power.png"></a></td><td><a href="figs/I010_A0012_D001_theta-power.png" onClick="window.open('figs/I010_A0012_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0012_D001_theta-power.png"></a></td><td><a href="figs/I010_A0012_D001_alpha-power.png" onClick="window.open('figs/I010_A0012_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0012_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0012_D001_beta-power.png" onClick="wndow.open('figs/I010_A0012_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0012_D001_beta-power.png"></a></td><td><a href="figs/I010_A0012_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0012_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0012_D001_high-gamma-power.png"></a></td></tr>
% <tr><td style="background-color:#00FFFF"><i>University of Eastern Finland</i><p>I010_A0013_D001<br>Rat<br>2 chs  06:20:34:09<br>200 Hz</td><td><a href="figs/I010_A0013_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0013_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0013_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0013_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0013_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0013_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0013_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0013_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0013_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0013_D001_delta-power.png" onClick="window.open('figs/I010_A0013_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0013_D001_delta-power.png"></a></td><td><a href="figs/I010_A0013_D001_theta-power.png" onClick="window.open('figs/I010_A0013_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0013_D001_theta-power.png"></a></td><td><a href="figs/I010_A0013_D001_alpha-power.png" onClick="window.open('figs/I010_A0013_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0013_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0013_D001_beta-power.png" onClick="wndow.open('figs/I010_A0013_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0013_D001_beta-power.png"></a></td><td><a href="figs/I010_A0013_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0013_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0013_D001_high-gamma-power.png"></a></td></tr>
% <tr><td style="background-color:red"><i>University of Eastern Finland</i><p>I010_A0014_D001<br>Rat<br>2 chs  06:20:34:09<br>200 Hz</td><td><a href="figs/I010_A0014_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0014_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0014_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0014_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0014_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0014_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0014_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0014_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0014_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0014_D001_delta-power.png" onClick="window.open('figs/I010_A0014_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0014_D001_delta-power.png"></a></td><td><a href="figs/I010_A0014_D001_theta-power.png" onClick="window.open('figs/I010_A0014_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0014_D001_theta-power.png"></a></td><td><a href="figs/I010_A0014_D001_alpha-power.png" onClick="window.open('figs/I010_A0014_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0014_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0014_D001_beta-power.png" onClick="wndow.open('figs/I010_A0014_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0014_D001_beta-power.png"></a></td><td><a href="figs/I010_A0014_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0014_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0014_D001_high-gamma-power.png"></a></td></tr>
% <tr><td style="background-color:red"><i>University of Eastern Finland</i><p>I010_A0015_D001<br>Rat<br>2 chs  06:17:21:03<br>200 Hz</td><td><a href="figs/I010_A0015_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0015_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0015_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0015_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0015_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0015_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0015_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0015_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0015_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0015_D001_delta-power.png" onClick="window.open('figs/I010_A0015_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0015_D001_delta-power.png"></a></td><td><a href="figs/I010_A0015_D001_theta-power.png" onClick="window.open('figs/I010_A0015_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0015_D001_theta-power.png"></a></td><td><a href="figs/I010_A0015_D001_alpha-power.png" onClick="window.open('figs/I010_A0015_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0015_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0015_D001_beta-power.png" onClick="wndow.open('figs/I010_A0015_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0015_D001_beta-power.png"></a></td><td><a href="figs/I010_A0015_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0015_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0015_D001_high-gamma-power.png"></a></td></tr>
% <tr><td style="background-color:#00FFFF"><i>University of Eastern Finland</i><p>I010_A0016_D001<br>Rat<br>2 chs  06:17:21:03<br>200 Hz</td><td><a href="figs/I010_A0016_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0016_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0016_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0016_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0016_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0016_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0016_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0016_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0016_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0016_D001_delta-power.png" onClick="window.open('figs/I010_A0016_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0016_D001_delta-power.png"></a></td><td><a href="figs/I010_A0016_D001_theta-power.png" onClick="window.open('figs/I010_A0016_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0016_D001_theta-power.png"></a></td><td><a href="figs/I010_A0016_D001_alpha-power.png" onClick="window.open('figs/I010_A0016_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0016_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0016_D001_beta-power.png" onClick="wndow.open('figs/I010_A0016_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0016_D001_beta-power.png"></a></td><td><a href="figs/I010_A0016_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0016_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0016_D001_high-gamma-power.png"></a></td></tr>
% <tr><td style="background-color:gray"><i>University of Eastern Finland</i><p>I010_A0017_D001<br>Rat<br>2 chs  06:20:34:09<br>200 Hz</td><td><a href="figs/I010_A0017_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0017_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0017_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0017_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0017_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0017_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0017_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0017_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0017_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0017_D001_delta-power.png" onClick="window.open('figs/I010_A0017_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0017_D001_delta-power.png"></a></td><td><a href="figs/I010_A0017_D001_theta-power.png" onClick="window.open('figs/I010_A0017_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0017_D001_theta-power.png"></a></td><td><a href="figs/I010_A0017_D001_alpha-power.png" onClick="window.open('figs/I010_A0017_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0017_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0017_D001_beta-power.png" onClick="wndow.open('figs/I010_A0017_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0017_D001_beta-power.png"></a></td><td><a href="figs/I010_A0017_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0017_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0017_D001_high-gamma-power.png"></a></td></tr>
% <tr><td style="background-color:red"><i>University of Eastern Finland</i><p>I010_A0018_D001<br>Rat<br>2 chs  06:17:21:03<br>200 Hz</td><td><a href="figs/I010_A0018_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0018_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0018_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0018_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0018_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0018_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0018_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0018_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0018_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0018_D001_delta-power.png" onClick="window.open('figs/I010_A0018_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0018_D001_delta-power.png"></a></td><td><a href="figs/I010_A0018_D001_theta-power.png" onClick="window.open('figs/I010_A0018_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0018_D001_theta-power.png"></a></td><td><a href="figs/I010_A0018_D001_alpha-power.png" onClick="window.open('figs/I010_A0018_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0018_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0018_D001_beta-power.png" onClick="wndow.open('figs/I010_A0018_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0018_D001_beta-power.png"></a></td><td><a href="figs/I010_A0018_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0018_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0018_D001_high-gamma-power.png"></a></td></tr>
% <tr><td style="background-color:gray"><i>University of Eastern Finland</i><p>I010_A0019_D001<br>Rat<br>2 chs  06:20:34:09<br>200 Hz</td><td><a href="figs/I010_A0019_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0019_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0019_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0019_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0019_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0019_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0019_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0019_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0019_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0019_D001_delta-power.png" onClick="window.open('figs/I010_A0019_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0019_D001_delta-power.png"></a></td><td><a href="figs/I010_A0019_D001_theta-power.png" onClick="window.open('figs/I010_A0019_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0019_D001_theta-power.png"></a></td><td><a href="figs/I010_A0019_D001_alpha-power.png" onClick="window.open('figs/I010_A0019_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0019_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0019_D001_beta-power.png" onClick="wndow.open('figs/I010_A0019_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0019_D001_beta-power.png"></a></td><td><a href="figs/I010_A0019_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0019_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0019_D001_high-gamma-power.png"></a></td></tr>
% <tr><td style="background-color:red"><i>University of Eastern Finland</i><p>I010_A0020_D001<br>Rat<br>2 chs  06:20:34:09<br>200 Hz</td><td><a href="figs/I010_A0020_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0020_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0020_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0020_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0020_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0020_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0020_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0020_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0020_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0020_D001_delta-power.png" onClick="window.open('figs/I010_A0020_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0020_D001_delta-power.png"></a></td><td><a href="figs/I010_A0020_D001_theta-power.png" onClick="window.open('figs/I010_A0020_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0020_D001_theta-power.png"></a></td><td><a href="figs/I010_A0020_D001_alpha-power.png" onClick="window.open('figs/I010_A0020_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0020_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0020_D001_beta-power.png" onClick="wndow.open('figs/I010_A0020_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0020_D001_beta-power.png"></a></td><td><a href="figs/I010_A0020_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0020_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0020_D001_high-gamma-power.png"></a></td></tr>
% <tr><td style="background-color:#00FFFF"><i>University of Eastern Finland</i><p>I010_A0021_D001<br>Rat<br>2 chs  06:17:21:03<br>200 Hz</td><td><a href="figs/I010_A0021_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0021_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0021_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0021_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0021_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0021_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0021_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0021_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0021_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0021_D001_delta-power.png" onClick="window.open('figs/I010_A0021_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0021_D001_delta-power.png"></a></td><td><a href="figs/I010_A0021_D001_theta-power.png" onClick="window.open('figs/I010_A0021_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0021_D001_theta-power.png"></a></td><td><a href="figs/I010_A0021_D001_alpha-power.png" onClick="window.open('figs/I010_A0021_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0021_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0021_D001_beta-power.png" onClick="wndow.open('figs/I010_A0021_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0021_D001_beta-power.png"></a></td><td><a href="figs/I010_A0021_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0021_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0021_D001_high-gamma-power.png"></a></td></tr>
% <tr><td style="background-color:gray"><i>University of Eastern Finland</i><p>I010_A0022_D001<br>Rat<br>2 chs  06:20:34:09<br>200 Hz</td><td><a href="figs/I010_A0022_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0022_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0022_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0022_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0022_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0022_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0022_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0022_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0022_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0022_D001_delta-power.png" onClick="window.open('figs/I010_A0022_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0022_D001_delta-power.png"></a></td><td><a href="figs/I010_A0022_D001_theta-power.png" onClick="window.open('figs/I010_A0022_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0022_D001_theta-power.png"></a></td><td><a href="figs/I010_A0022_D001_alpha-power.png" onClick="window.open('figs/I010_A0022_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0022_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0022_D001_beta-power.png" onClick="wndow.open('figs/I010_A0022_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0022_D001_beta-power.png"></a></td><td><a href="figs/I010_A0022_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0022_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0022_D001_high-gamma-power.png"></a></td></tr>
% <tr><td style="background-color:red"><i>University of Eastern Finland</i><p>I010_A0023_D001<br>Rat<br>2 chs  06:20:34:09<br>200 Hz</td><td><a href="figs/I010_A0023_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0023_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0023_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0023_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0023_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0023_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0023_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0023_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0023_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0023_D001_delta-power.png" onClick="window.open('figs/I010_A0023_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0023_D001_delta-power.png"></a></td><td><a href="figs/I010_A0023_D001_theta-power.png" onClick="window.open('figs/I010_A0023_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0023_D001_theta-power.png"></a></td><td><a href="figs/I010_A0023_D001_alpha-power.png" onClick="window.open('figs/I010_A0023_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0023_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0023_D001_beta-power.png" onClick="wndow.open('figs/I010_A0023_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0023_D001_beta-power.png"></a></td><td><a href="figs/I010_A0023_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0023_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0023_D001_high-gamma-power.png"></a></td></tr>
% <tr><td style="background-color:#00FFFF"><i>University of Eastern Finland</i><p>I010_A0024_D001<br>Rat<br>2 chs  06:20:34:09<br>200 Hz</td><td><a href="figs/I010_A0024_D001_spike_detections_count.png" onClick="window.open('figs/I010_A0024_D001_spike_detections_count.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0024_D001_spike_detections_count.png"></a></td><td><a href="figs/I010_A0024_D001_burst_detections_count.png" onClick="window.open('figs/I010_A0024_D001_burst_detections_count.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0024_D001_burst_detections_count.png"></a></td><td><a href="figs/I010_A0024_D001_seizure_detections_count.png" onClick="window.open('figs/I010_A0024_D001_seizure_detections_count.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0024_D001_seizure_detections_count.png"></a></td><td><a href="figs/I010_A0024_D001_delta-power.png" onClick="window.open('figs/I010_A0024_D001_delta-power.png','delta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0024_D001_delta-power.png"></a></td><td><a href="figs/I010_A0024_D001_theta-power.png" onClick="window.open('figs/I010_A0024_D001_theta-power.png','theta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0024_D001_theta-power.png"></a></td><td><a href="figs/I010_A0024_D001_alpha-power.png" onClick="window.open('figs/I010_A0024_D001_alpha-power.png','alpha','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0024_D001_alpha-power.png"></a></td><td><a href="figs/I010_A0024_D001_beta-power.png" onClick="wndow.open('figs/I010_A0024_D001_beta-power.png','beta','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0024_D001_beta-power.png"></a></td><td><a href="figs/I010_A0024_D001_high-gamma-power.png" onClick="window.open('figs/I010_A0024_D001_high-gamma-power.png','high-gamma','left=0,width=1200,height=600'); return false;"><img src="figs/I010_A0024_D001_high-gamma-power.png"></a></td></tr>
% </table>
% <br>
% </html>




%% Group Comparisons
% Generate group comparisons for 1) Experimental vs Sham - Experimental group are the rats who received TBI, and the Sham group did not receive TBI.
% and 2) Seizure vs Non-Seizure - Seizure group were rats who later developed seizure (not during current monitoring period). 
% For each comparison, a two-sample t-test was
% calculated based on the counts of each event (e.g. spikes) between each
% group. A box-whisker plot is shown, and the resulting P-value is given.
% Note that results are heavily dependent on the quality of the automatic
% detectors, which are still under development. 

animalIdx = [1:7 7:23]; %create duplicate space for omitted animal 7
shamAnimals= [2 8 10 16 18 21];
%actual index
shamIdx = animalIdx(shamAnimals);

expAnimals= [1 3 4 5 6 9 11 12 13 14 15 17 19 20 22 23 24];
expIdx = animalIdx(expAnimals);

%nonSZAnimals= [1 3 4 5 8 13 15 16 20]; %possibly old indices
%SZAnimals = [2 6 7 9 10 11 12 14];

nonSZAnimals = [1 4 5 6 12 15 20 23 24];
SZAnimals = [3 9 11 13 14 17 19 22];
nonSZIdx = animalIdx(nonSZAnimals);
SZIdx = animalIdx(SZAnimals);

%{session.data(shamIdx).snapName}
%{session.data(SZIdx).snapName}
%{session.data(nonSZIdx).snapName}

generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{'Sham', 'nonSZ','SZ'},1:2,'spike_detections','Spikes Across Groups','Spikes Per Day','html/figs/');
generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{'Sham', 'nonSZ','SZ'},1,'spike_detections','Spikes Across Groups-CH1','Spikes Per Day','html/figs/');
generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{'Sham', 'nonSZ','SZ'},2,'spike_detections','Spikes Across Groups-CH2','Spikes Per Day','html/figs/');

generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{'Sham', 'nonSZ','SZ'},1:2,'burst_detections','Bursts Across Groups','Bursts Per Day','html/figs/');
generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{'Sham', 'nonSZ','SZ'},1:2,'burst_detections_1','Cluster 1 Bursts Across Groups','Bursts Per Day','html/figs/');
generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{'Sham', 'nonSZ','SZ'},1:2,'burst_detections_2','Cluster 2 Bursts Across Groups','Bursts Per Day','html/figs/');
generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{'Sham', 'nonSZ','SZ'},1:2,'burst_detections_3','Cluster 3 Bursts Across Groups','Bursts Per Day','html/figs/');

generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{'Sham', 'nonSZ','SZ'},1,'burst_detections','Bursts Across Groups-CH1','Bursts Per Day','html/figs/');
generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{'Sham', 'nonSZ','SZ'},1,'burst_detections_1','Cluster 1 Bursts Across Groups-CH1','Bursts Per Day','html/figs/');
generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{'Sham', 'nonSZ','SZ'},1,'burst_detections_2','Cluster 2 Bursts Across Groups-CH1','Bursts Per Day','html/figs/');
generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{'Sham', 'nonSZ','SZ'},1,'burst_detections_3','Cluster 3 Bursts Across Groups-CH1','Bursts Per Day','html/figs/');

generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{'Sham', 'nonSZ','SZ'},2,'burst_detections','Bursts Across Groups-CH2','Bursts Per Day','html/figs/');
generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{'Sham', 'nonSZ','SZ'},2,'burst_detections_1','Cluster 1 Bursts Across Groups-CH2','Bursts Per Day','html/figs/');
generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{'Sham', 'nonSZ','SZ'},2,'burst_detections_2','Cluster 2 Bursts Across Groups-CH2','Bursts Per Day','html/figs/');
generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{'Sham', 'nonSZ','SZ'},2,'burst_detections_3','Cluster 3 Bursts Across Groups-CH2','Bursts Per Day','html/figs/');




% generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},1:2,'spike_detections','Spikes Across Groups','Spikes Per Day','html/figs/');
% generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},1,'spike_detections','Spikes Across Groups-CH1','Spikes Per Day','html/figs/');
% generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},2,'spike_detections','Spikes Across Groups-CH2','Spikes Per Day','html/figs/');
% 
% generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},1:2,'burst_detections','Bursts Across Groups','Bursts Per Day','html/figs/');
% generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},1:2,'burst_detections_1','Cluster 1 Bursts Across Groups','Bursts Per Day','html/figs/');
% generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},1:2,'burst_detections_2','Cluster 2 Bursts Across Groups','Bursts Per Day','html/figs/');
% generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},1:2,'burst_detections_3','Cluster 3 Bursts Across Groups','Bursts Per Day','html/figs/');
% 
% generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},1,'burst_detections','Bursts Across Groups-CH1','Bursts Per Day','html/figs/');
% generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},1,'burst_detections_1','Cluster 1 Bursts Across Groups-CH1','Bursts Per Day','html/figs/');
% generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},1,'burst_detections_2','Cluster 2 Bursts Across Groups-CH1','Bursts Per Day','html/figs/');
% generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},1,'burst_detections_3','Cluster 3 Bursts Across Groups-CH1','Bursts Per Day','html/figs/');
% 
% generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},2,'burst_detections','Bursts Across Groups-CH2','Bursts Per Day','html/figs/');
% generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},2,'burst_detections_1','Cluster 1 Bursts Across Groups-CH2','Bursts Per Day','html/figs/');
% generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},2,'burst_detections_2','Cluster 2 Bursts Across Groups-CH2','Bursts Per Day','html/figs/');
% generate_all_group_plots(session.data(shamIdx),session.data(nonSZIdx),session.data(SZIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},2,'burst_detections_3','Cluster 3 Bursts Across Groups-CH2','Bursts Per Day','html/figs/');
% 

%generate per day plots
generate_group_plotsphr(session.data(shamIdx),session.data(expIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('Exp (N=%d)',numel(expIdx))},1,'burst_detections','Sham vs Exp Bursts','burstsch1','html/figs/');
generate_group_plotsphr(session.data(shamIdx),session.data(expIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('Exp (N=%d)',numel(expIdx))},1,'burst_detections_1','Sham vs Exp Bursts cluster 1','burst1ch1','html/figs/');
generate_group_plotsphr(session.data(shamIdx),session.data(expIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('Exp (N=%d)',numel(expIdx))},1,'burst_detections_2','Sham vs Exp Bursts cluster 2','burst2ch1','html/figs/');
generate_group_plotsphr(session.data(shamIdx),session.data(expIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('Exp (N=%d)',numel(expIdx))},1,'burst_detections_3','Sham vs Exp Bursts cluster 3','burst3ch1','html/figs/');

generate_group_plotsphr(session.data(nonSZIdx),session.data(SZIdx),{sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},1,'burst_detections','Non-epileptic vs epileptic Bursts','burstsch1','html/figs/');
generate_group_plotsphr(session.data(nonSZIdx),session.data(SZIdx),{sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},1,'burst_detections_1','Non-epileptic vs epileptic Bursts cluster 1','burst1ch1','html/figs/');
generate_group_plotsphr(session.data(nonSZIdx),session.data(SZIdx),{sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},1,'burst_detections_2','Non-epileptic vs epileptic Bursts cluster 2','burst2ch1','html/figs/');
generate_group_plotsphr(session.data(nonSZIdx),session.data(SZIdx),{sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},1,'burst_detections_3','Non-epileptic vs epileptic Bursts cluster 3','burst3ch1','html/figs/');

generate_group_plotsphr(session.data(shamIdx),session.data(expIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('Exp (N=%d)',numel(expIdx))},1:2,'spike_detections','Sham vs Exp Spikes','spike','html/figs/');
generate_group_plotsphr(session.data(nonSZIdx),session.data(SZIdx),{sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},1:2,'spike_detections','Non-epileptic vs epileptic Spikes','spike','html/figs/');
generate_group_plotsphr(session.data(shamIdx),session.data(expIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('Exp (N=%d)',numel(expIdx))},1,'spike_detections','Sham vs Exp Spikes','spikech1','html/figs/');
generate_group_plotsphr(session.data(nonSZIdx),session.data(SZIdx),{sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},1,'spike_detections','Non-epileptic vs epileptic Spikes','spikech1','html/figs/');
% 
% %generate group comparison plots
% generate_group_plots(session.data(shamIdx),session.data(expIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('Exp (N=%d)',numel(expIdx))},'spike_detections','Sham_Exp','spike','html/figs/');
% generate_group_plots(session.data(shamIdx),session.data(expIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('Exp (N=%d)',numel(expIdx))},'burst_detections','Sham_Exp','burst','html/figs/');
% generate_group_plots(session.data(shamIdx),session.data(expIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('Exp (N=%d)',numel(expIdx))},'seizure_detections','Sham_Exp','seizure','html/figs/');
% generate_group_plots(session.data(shamIdx),session.data(expIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('Exp (N=%d)',numel(expIdx))},'delta_avg','Sham_Exp_davg','ratio','html/figs/');
% generate_group_plots(session.data(shamIdx),session.data(expIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('Exp (N=%d)',numel(expIdx))},'delta_theta','Sham_Exp_dt','ratio','html/figs/');
% generate_group_plots(session.data(shamIdx),session.data(expIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('Exp (N=%d)',numel(expIdx))},'delta_alpha','Sham_Exp_da','ratio','html/figs/');
% generate_group_plots(session.data(shamIdx),session.data(expIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('Exp (N=%d)',numel(expIdx))},'delta_beta','Sham_Exp_db','ratio','html/figs/');
% generate_group_plots(session.data(shamIdx),session.data(expIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('Exp (N=%d)',numel(expIdx))},'delta_high-gamma','Sham_Exp_dhg','ratio','html/figs/');
% 
% generate_group_plots(session.data(shamIdx),session.data(expIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('Exp (N=%d)',numel(expIdx))},'burst_detections_1','Sham_Exp','burst1','html/figs/');
% generate_group_plots(session.data(nonSZIdx),session.data(SZIdx),{sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},'burst_detections_1','nonSZ_SZ','burst1','html/figs/');
% 
% generate_group_plots2(session.data(shamIdx),session.data(expIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('Exp (N=%d)',numel(expIdx))},1,'burst_detections_1','Sham_Exp','burst1ch1','html/figs/');
% generate_group_plots2(session.data(nonSZIdx),session.data(SZIdx),{sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},1,'burst_detections_1','nonSZ_SZ','burst1ch1','html/figs/');
% 
% generate_group_plots2(session.data(shamIdx),session.data(expIdx),{sprintf('Sham (N=%d)',numel(shamIdx)),sprintf('Exp (N=%d)',numel(expIdx))},2,'burst_detections_2','Sham_Exp','burst2ch2','html/figs/');
% generate_group_plots2(session.data(nonSZIdx),session.data(SZIdx),{sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},2,'burst_detections_2','nonSZ_SZ','burst2ch2','html/figs/');
% 
% generate_group_plots(session.data(nonSZIdx),session.data(SZIdx),{sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},'spike_detections','nonSZ_SZ','spike','html/figs/');
% generate_group_plots(session.data(nonSZIdx),session.data(SZIdx),{sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},'burst_detections','nonSZ_SZ','burst','html/figs/');
% generate_group_plots(session.data(nonSZIdx),session.data(SZIdx),{sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},'seizure_detections','nonSZ_SZ','seizure','html/figs/');
% generate_group_plots(session.data(nonSZIdx),session.data(SZIdx),{sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},'delta_avg','nonSZ_SZ_davg','ratio','html/figs/');
% generate_group_plots(session.data(nonSZIdx),session.data(SZIdx),{sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},'delta_theta','nonSZ_SZ_dt','ratio','html/figs/');
% generate_group_plots(session.data(nonSZIdx),session.data(SZIdx),{sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},'delta_alpha','nonSZ_SZ_da','ratio','html/figs/');
% generate_group_plots(session.data(nonSZIdx),session.data(SZIdx),{sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},'delta_beta','nonSZ_SZ_db','ratio','html/figs/');
% generate_group_plots(session.data(nonSZIdx),session.data(SZIdx),{sprintf('nonSZ (N=%d)',numel(nonSZIdx)),sprintf('SZ (N=%d)',numel(SZIdx))},'delta_high-gamma','nonSZ_SZ_dhg','ratio','html/figs/');

%%
% <html><br></html>

%% Preliminary Results
% There were no significant differences found in the counts of spikes,
% bursts, or seizures in the two comparisons.

%%
% <html>
% <style type="text/css">
% table.org { margin-left: 25px; }
% table.org th { text-align:center; color:rgb(213,80,0); font-size:14px; font-weight:bold; }
% table.org td { text-align:center; vertical-align:middle; font-size:14px; font-weight:normal; }
% table.org p { font-size:10px; font-weight:normal; margin-bottom: 0px; }
% table.org img { width:200px; height:90px; margin-bottom:0px; cursor: alias; }
% table.org span>img { cursor: pointer; }
% table.org span:hover, table.org a:hover { background: gold; cursor: pointer; text-decoration: none; }
% table.org .na { background-color:#f8f8f8; }
% </style>
% <table class="org" border=1>
% <tr><th>Contrast</th><th>Spikes</th><th>Bursts</th><th>Seizures</th><th>Delta-avg-ratio</th><th>Delta-theta-ratio</th><th>Delta-alpha-ratio</th><th>Delta-beta-ratio</th><th>Delta-high-gamma-ratio</th></tr>
% <tr><td><i>Sham vs Exp</i></td><td><a href="figs/Sham_Exp_spike.png" onClick="window.open('figs/Sham_Exp_spike.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/Sham_Exp_spike.png"></a></td><td><a href="figs/Sham_Exp_burst.png" onClick="window.open('figs/Sham_Exp_burst.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/Sham_Exp_burst.png"></a></td><td><a href="figs/Sham_Exp_seizure.png" onClick="window.open('figs/Sham_Exp_seizure.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/Sham_Exp_seizure.png"></a></td><td><a href="figs/Sham_Exp_davg_ratio.png" onClick="window.open('figs/Sham_Exp_davg_ratio.png','davg_ratio','left=0,width=1200,height=600'); return false;"><img src="figs/Sham_Exp_davg_ratio.png"></a></td><td><a href="figs/Sham_Exp_dt_ratio.png" onClick="window.open('figs/Sham_Exp_dt_ratio.png','dt_ratio','left=0,width=1200,height=600'); return false;"><img src="figs/Sham_Exp_dt_ratio.png"></a></td><td><a href="figs/Sham_Exp_da_ratio.png" onClick="window.open('figs/Sham_Exp_da_ratio.png','da_ratio','left=0,width=1200,height=600'); return false;"><img src="figs/Sham_Exp_da_ratio.png"></a></td><td><a href="figs/Sham_Exp_db_ratio.png" onClick="window.open('figs/Sham_Exp_db_ratio.png','db_ratio','left=0,width=1200,height=600'); return false;"><img src="figs/Sham_Exp_db_ratio.png"></a></td><td><a href="figs/Sham_Exp_dhg_ratio.png" onClick="window.open('figs/Sham_Exp_dhg_ratio.png','dhg_ratio','left=0,width=1200,height=600'); return false;"><img src="figs/Sham_Exp_dhg_ratio.png"></a></td></tr>
% <tr><td><i>nonSZ vs SZ</i></td><td><a href="figs/nonSZ_SZ_spike.png" onClick="window.open('figs/nonSZ_SZ_spike.png','spike','left=0,width=1200,height=600'); return false;"><img src="figs/nonSZ_SZ_spike.png"></a></td><td><a href="figs/nonSZ_SZ_burst.png" onClick="window.open('figs/nonSZ_SZ_burst.png','burst','left=0,width=1200,height=600'); return false;"><img src="figs/nonSZ_SZ_burst.png"></a></td><td><a href="figs/nonSZ_SZ_seizure.png" onClick="window.open('figs/nonSZ_SZ_seizure.png','seizure','left=0,width=1200,height=600'); return false;"><img src="figs/nonSZ_SZ_seizure.png"></a></td><td><a href="figs/nonSZ_SZ_davg_ratio.png" onClick="window.open('figs/nonSZ_SZ_davg_ratio.png','davg_ratio','left=0,width=1200,height=600'); return false;"><img src="figs/nonSZ_SZ_davg_ratio.png"></a></td><td><a href="figs/nonSZ_SZ_dt_ratio.png" onClick="window.open('figs/nonSZ_SZ_dt_ratio.png','dt_ratio','left=0,width=1200,height=600'); return false;"><img src="figs/nonSZ_SZ_dt_ratio.png"></a></td><td><a href="figs/nonSZ_SZ_da_ratio.png" onClick="window.open('figs/nonSZ_SZ_da_ratio.png','da_ratio','left=0,width=1200,height=600'); return false;"><img src="figs/nonSZ_SZ_da_ratio.png"></a></td><td><a href="figs/nonSZ_SZ_db_ratio.png" onClick="window.open('figs/nonSZ_SZ_db_ratio.png','db_ratio','left=0,width=1200,height=600'); return false;"><img src="figs/nonSZ_SZ_db_ratio.png"></a></td><td><a href="figs/nonSZ_SZ_dhg_ratio.png" onClick="window.open('figs/nonSZ_SZ_dhg_ratio.png','dhg_ratio','left=0,width=1200,height=600'); return false;"><img src="figs/nonSZ_SZ_dhg_ratio.png"></a></td></tr>
% </table>
% <br>
% </html>

